
function [oneMonQuittingUrbanProb, oneMonQuittingRuralProb, oneMonStartingUrbanProb, oneMonStartingRuralProb] = smokingChurnMaker
%Smoking Churn maker
%function call: [oneMonQuittingUrbanProb, oneMonQuittingRuralProb,
%oneMonStartingUrbanProb, oneMonStartingRuralProb] = smokingChurnMaker


fiveYrageBrac = [...
5
10
15
20
25
30
35
45
55
75
100
];

%whole matrix
fiveYrQuittingUrban=[...
0.81207	0.7921	0.80363	0.88323	0.75587	0.8179	0.79432	0.80597	0.78012	0.73247	0.71648	0.60761
0.92092	0.87937	0.88501	0.85908	0.88765	0.8934	0.84637	0.87105	0.8766	0.83828	0.81583	0.70519
0.91516	0.92794	0.92436	0.94928	0.88703	0.89143	0.89204	0.82454	0.81874	0.87425	0.59735	0.75599
0.88702	0.83348	0.86912	0.87679	0.85199	0.86379	0.78413	0.78449	0.81761	0.78185	0.77446	0.74099
0.60002	0.64953	0.56623	0.57578	0.54405	0.60549	0.78202	0.82067	0.68894	0.79942	0.91184	0.75308
0.44817	0.43161	0.51611	0.44926	0.5725	0.44179	0.83272	0.75451	0.7213	0.77818	0.8233	0.85351
0.25986	0.29735	0.23081	0.26232	0.27545	0.27129	0.63524	0.73164	0.7826	0.69835	0.85788	0.81237
0.12978	0.05102	0.10432	0.05816	0.15354	0.10239	0.57997	0.55622	0.68427	0.70835	0.64914	0.69979
0.1178	0.15511	0.09765	0.06307	0.30102	0.11658	0.355815	0.41035	0.37409	0.371245	0.397995	0.39958
0.001178	0.0015511	0.0009765	0.0006307	0.0030102	0.0011658	0.37360575	0.4308675	0.3927945	0.38980725	0.41789475	0.419559
0	0	0	0	0	0	0	0	0	0	0	0
];

fiveYrQuittingRural=[...
0.79365	0.67301	0.85188	0.74298	0.73545	0.79202	0.76706	0.85616	0.68611	0.61809	0.76973	0.85478
0.86026	0.87912	0.89795	0.8672	0.88871	0.86519	0.77827	0.82396	0.83376	0.84244	0.8626	0.89626
0.90387	0.89875	0.91409	0.95076	0.9121	0.93447	0.72678	0.88698	0.754	0.89122	0.83311	0.84486
0.88779	0.8603	0.86211	0.87525	0.81546	0.84076	0.76877	0.89522	0.83821	0.8456	0.84426	0.88439
0.56256	0.60946	0.59062	0.53129	0.63634	0.57673	0.84745	0.71721	0.82199	0.84971	0.85576	0.79047
0.43436	0.40128	0.4241	0.42383	0.52245	0.41024	0.80732	0.75382	0.71462	0.70928	0.74057	0.80984
0.202	0.23982	0.24663	0.21061	0.20642	0.24993	0.67716	0.58027	0.61592	0.53511	0.76364	0.67184
0.06386	0.09302	0.05727	0.05579	0.13624	0.04973	0.45048	0.23576	0.30572	0.31094	0.608715	0.55279
0.08643	0.06477	0.11973	0.01949	0.18666	0.08673	0.3484575	0.3777375	0.3658725	0.270855	0.59559	0.501285
0.0008643	0.0006477	0.0011973	0.0001949	0.0018666	0.0008673	0.365880375	0.396624375	0.384166125	0.28439775	0.6253695	0.52634925
0	0	0	0	0	0	0	0	0	0	0	0    
];

fiveYrStartingUrban=[...
0	0	0	0	0	0	0	0	0	0	0	0
0.02733	0.0223125	0.029115	0.02952	0.0162825	0.02604	0.001715	0.00225	0.00293	0.00218	0.001715	0.001805
0.09267	0.1019625	0.0996975	0.125775	0.05553	0.088335	0.004535	0.005125	0.004105	0.0066	0.003135	0.00351
0.216738	0.206073	0.223578	0.282996	0.129924	0.21375	0.007455	0.009515	0.008105	0.008985	0.003975	0.00595
0.1876	0.2025	0.19514	0.23406	0.10706	0.18975	0.01126125	0.015915	0.013095	0.012483	0.007815	0.0063225
0.096336	0.102645	0.118872	0.135639	0.07596	0.100548	0.01266	0.0178875	0.01359	0.0147675	0.009901125	0.0083325
0.05309	0.05995	0.05717	0.07881	0.03523	0.0579	0.01467	0.01904	0.02108	0.02368	0.00819	0.01557
0.022149	0.016731	0.02151	0.021987	0.018378	0.020169	0.011475	0.0140325	0.0165225	0.024105	0.0051525	0.0100875
0.00694	0.00839	0.00814	0.01067	0.01197	0.01193	0.00647	0.00901	0.00975	0.01137	0.00428	0.00609
0.007634	0.009229	0.008954	0.011737	0.013167	0.013123	0.003235	0.004505	0.004875	0.005685	0.00214	0.003045
0.007634	0.009229	0.008954	0.011737	0.013167	0.013123	0.003235	0.004505	0.004875	0.005685	0.00214	0.003045    
];

fiveYrStartingRural=[...
0	0	0	0	0	0	0	0	0	0	0	0
0.016335	0.01827	0.0177675	0.0260325	0.0125925	0.02127	0.00088	0.002225	0.00107	0.001975	0.00153	0.00161
0.0887025	0.089655	0.10056	0.124575	0.0638475	0.097305	0.00339	0.006035	0.00578	0.0053	0.00212	0.00376
0.227511	0.234936	0.246033	0.298026	0.131229	0.218529	0.00656	0.009295	0.01076	0.01775	0.003865	0.008365
0.19789	0.21299	0.22269	0.24523	0.14463	0.20613	0.0188925	0.028695	0.0266025	0.0304875	0.007965	0.0132
0.112194	0.118206	0.12402	0.157545	0.085932	0.110727	0.029025	0.033165	0.0299925	0.0422625	0.0093525	0.0185775
0.05943	0.07035	0.0773	0.09289	0.03816	0.0727	0.0357	0.0316	0.02936	0.03383	0.00927	0.02321
0.0237025	0.029374	0.027037	0.035131	0.02242	0.023655	0.0217275	0.0182325	0.017745	0.0246075	0.008535	0.02271
0.01098	0.00923	0.01534	0.01128	0.01077	0.01083	0.01448	0.01943	0.01733	0.01385	0.00937	0.00889
0.011529	0.0096915	0.016107	0.011844	0.0113085	0.0113715	0.015928	0.021373	0.019063	0.015235	0.010307	0.009779
0.011529	0.0096915	0.016107	0.011844	0.0113085	0.0113715	0.015928	0.021373	0.019063	0.015235	0.010307	0.009779
];


%make one year linear interpolations
oneYrAgeBrac = [5:1:100]';
oneYrQuittingUrban = interp1(fiveYrageBrac,fiveYrQuittingUrban,oneYrAgeBrac);
oneYrQuittingRural = interp1(fiveYrageBrac,fiveYrQuittingRural,oneYrAgeBrac);
oneYrStartingUrban = interp1(fiveYrageBrac,fiveYrStartingUrban,oneYrAgeBrac);
oneYrStartingRural = interp1(fiveYrageBrac,fiveYrStartingRural,oneYrAgeBrac);

%plot(fiveYrageBrac,FiveYrQuitting,'o',oneYrAgeBrac,ans,'-');

%change to rates
oneMonQuittingUrbanRate = -log(1-oneYrQuittingUrban);
oneMonQuittingRuralRate = -log(1-oneYrQuittingRural);
oneMonStartingUrbanRate = -log(1-oneYrStartingUrban);
oneMonStartingRuralRate = -log(1-oneYrStartingRural);

%weight monthly weights by region (generated using the urbanRural
%population stata datasets) to get national rates
ruralMaleWeight = [...
0.08568
0.0304669
0.0920072
0.0163934
0.0736451
0.0727961
];

ruralFemaleWeight = [...
0.0778527
0.0288646
0.0871716
0.0154662
0.0690606
0.0724344
];
    
urbanMaleWeight = [...
0.0323816
0.0102851
0.0219868
0.0031141
0.0415313
0.0370676
];

urbanFemaleWeight = [...
0.0277069
0.0093073
0.0194478
0.0028032
0.036379
0.0361508
];

natQuittingUrbanRateMale = oneMonQuittingUrbanRate(:,1:6)*urbanMaleWeight;
natQuittingRuralRateMale = oneMonQuittingRuralRate(:,1:6)*ruralMaleWeight;

natStartingUrbanRateMale = oneMonStartingUrbanRate(:,1:6)*urbanMaleWeight;
natStartingRuralRateMale = oneMonStartingRuralRate(:,1:6)*ruralMaleWeight;

natQuittingUrbanRateFemale = oneMonQuittingUrbanRate(:,7:12)*urbanFemaleWeight;
natQuittingRuralRateFemale = oneMonQuittingRuralRate(:,7:12)*ruralFemaleWeight;

natStartingUrbanRateFemale = oneMonStartingUrbanRate(:,7:12)*urbanFemaleWeight;
natStartingRuralRateFemale = oneMonStartingRuralRate(:,7:12)*ruralFemaleWeight;

natQuittingUrbanRate = [natQuittingUrbanRateMale,natQuittingUrbanRateFemale];
natQuittingRuralRate = [natQuittingRuralRateMale,natQuittingRuralRateFemale];
natStartingUrbanRate = [natStartingUrbanRateMale,natStartingUrbanRateFemale];
natStartingRuralRate = [natStartingRuralRateMale,natStartingRuralRateFemale];

%change back to probabilities (one year probs)
oneMonQuittingUrbanProb = 1-exp(-natQuittingUrbanRate);
oneMonQuittingRuralProb = 1-exp(-natQuittingRuralRate);
oneMonStartingUrbanProb = 1-exp(-natStartingUrbanRate);
oneMonStartingRuralProb = 1-exp(-natStartingRuralRate);



